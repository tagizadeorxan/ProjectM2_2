let dataExcel = [
  {
    Bank: "Газпромбанк",
    Deposit: "Ваш успех",
    Currency: "RUB",
    monthlyDeposit: 6.22,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Кредит Европа Банк",
    Deposit: "Оптимальный на 2 года",
    Currency: "RUB",
    monthlyDeposit: 6.45,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 24,
    MaximumTerm: 24,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Банк Зенит",
    Deposit: "Праздничный 500+",
    Currency: "RUB",
    monthlyDeposit: 6,
    minimumDeposit: 30000,
    maximumDeposit: null,
    minimumTerm: 17,
    MaximumTerm: 17,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Еврофинанс Моснарбанк",
    Deposit: "Классический",
    Currency: "RUB",
    monthlyDeposit: 6.95,
    minimumDeposit: 30000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 24,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Джей энд Ти Банк",
    Deposit: "Магнус-Онлайн",
    Currency: "RUB",
    monthlyDeposit: 6.8,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "МТС Банк",
    Deposit: "В вашу пользу",
    Currency: "RUB",
    monthlyDeposit: 6.75,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Эс-Би-Ай Банк",
    Deposit: "Свои правила Онлайн",
    Currency: "RUB",
    monthlyDeposit: 6.7,
    minimumDeposit: 30000,
    maximumDeposit: 30000000,
    minimumTerm: 24,
    MaximumTerm: 24,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Банк Уралсиб",
    Deposit: "Прогноз отличный",
    Currency: "RUB",
    monthlyDeposit: 6.7,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 37,
    MaximumTerm: 37,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Инвестторгбанк",
    Deposit: "ИТБ-Постоянный доход",
    Currency: "RUB",
    monthlyDeposit: 6.6,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 37,
    MaximumTerm: 37,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Транскапиталбанк",
    Deposit: "ТКБ.Постоянный доход",
    Currency: "RUB",
    monthlyDeposit: 6.6,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 37,
    MaximumTerm: 37,
    avaliableMonthly: "FALSE"
  },
  {
    Bank: "Совкомбанк",
    Deposit: "Зимний праздник с Халвой",
    Currency: "RUB",
    monthlyDeposit: 5.6,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 2,
    MaximumTerm: 2,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Агророс",
    Deposit: "Медовый месяц",
    Currency: "RUB",
    monthlyDeposit: 5.51,
    minimumDeposit: 20000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 1,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Росдорбанк",
    Deposit: "Онлайн-1",
    Currency: "RUB",
    monthlyDeposit: 5.1,
    minimumDeposit: 100000,
    maximumDeposit: 150000000,
    minimumTerm: 1,
    MaximumTerm: 1,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Национальный Стандарт",
    Deposit: "Сберегательный стандарт",
    Currency: "RUB",
    monthlyDeposit: 5.1,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Россия",
    Deposit: "Морозные узоры",
    Currency: "RUB",
    monthlyDeposit: 5,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 1,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Кузнецкий Мост",
    Deposit: "Накопительный",
    Currency: "RUB",
    monthlyDeposit: 4.85,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Тексбанк",
    Deposit: "Универсальный",
    Currency: "RUB",
    monthlyDeposit: 4.6,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 1,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Морской Банк",
    Deposit: "Правильным курсом +",
    Currency: "RUB",
    monthlyDeposit: 4.55,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Норвик Банк",
    Deposit: "Лаконичный",
    Currency: "RUB",
    monthlyDeposit: 4.5,
    minimumDeposit: 500,
    maximumDeposit: 50000000,
    minimumTerm: 1,
    MaximumTerm: 1,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Промсельхозбанк",
    Deposit: "Конструктор",
    Currency: "RUB",
    monthlyDeposit: 4.5,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 1,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Акибанк",
    Deposit: "Онлайн",
    Currency: "RUB",
    monthlyDeposit: 6.5,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Банк БКФ",
    Deposit: "Ключевой стандарт",
    Currency: "RUB",
    monthlyDeposit: 6.5,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 13,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Экспобанк",
    Deposit: "Специальный (в конце срока)",
    Currency: "RUB",
    monthlyDeposit: 6.35,
    minimumDeposit: 50000,
    maximumDeposit: 10000000,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Инвестторгбанк",
    Deposit: "ИТБ-Пополняемый",
    Currency: "RUB",
    monthlyDeposit: 6.15,
    minimumDeposit: 50000,
    maximumDeposit: 30000000,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Транскапиталбанк",
    Deposit: "ТКБ.Пополняемый",
    Currency: "RUB",
    monthlyDeposit: 6.15,
    minimumDeposit: 50000,
    maximumDeposit: 30000000,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Евроазиатский Инвестиционный Банк",
    Deposit: "Классика",
    Currency: "RUB",
    monthlyDeposit: 6.1,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Тимер Банк",
    Deposit: "Надежный выбор",
    Currency: "RUB",
    monthlyDeposit: 6,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Евразийский Банк",
    Deposit: "TURBO MAXIMUM",
    Currency: "RUB",
    monthlyDeposit: 6,
    minimumDeposit: 30000,
    maximumDeposit: 299999,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Таврический Банк",
    Deposit: "Достижимый (онлайн)",
    Currency: "RUB",
    monthlyDeposit: 6,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 6,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Экспобанк",
    Deposit: "Юбилейный 25 (в конце срока)",
    Currency: "RUB",
    monthlyDeposit: 6.5,
    minimumDeposit: 100000,
    maximumDeposit: 20000000,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Крокус-Банк",
    Deposit: "Ежемесячный доход",
    Currency: "RUB",
    monthlyDeposit: 6.35,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Промсельхозбанк",
    Deposit: "Ваш выбор",
    Currency: "RUB",
    monthlyDeposit: 6.3,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Нацинвестпромбанк",
    Deposit: "Прибыльный",
    Currency: "RUB",
    monthlyDeposit: 6.3,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Ишбанк",
    Deposit: "Накопительный",
    Currency: "RUB",
    monthlyDeposit: 6.25,
    minimumDeposit: 100000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Примсоцбанк",
    Deposit: "Новогодний чулок (333 дня)",
    Currency: "RUB",
    monthlyDeposit: 6.2,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 11,
    MaximumTerm: 11,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Еврофинанс Моснарбанк",
    Deposit: "Пополняемый",
    Currency: "RUB",
    monthlyDeposit: 6.75,
    minimumDeposit: 1000000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 24,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Евроазиатский Инвестиционный Банк",
    Deposit: "VIP",
    Currency: "RUB",
    monthlyDeposit: 6.35,
    minimumDeposit: 1000000,
    maximumDeposit: null,
    minimumTerm: 9,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Российская Финансовая Корпорация",
    Deposit: "Универсальный",
    Currency: "RUB",
    monthlyDeposit: 6,
    minimumDeposit: 5000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Московский Кредитный Банк",
    Deposit: "МЕГА Онлайн",
    Currency: "RUB",
    monthlyDeposit: 5.8,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 5,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Александровский",
    Deposit: "Черника 19/20",
    Currency: "RUB",
    monthlyDeposit: 5.6,
    minimumDeposit: 20000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Финанс Бизнес Банк",
    Deposit: "Мандариновый!",
    Currency: "RUB",
    monthlyDeposit: 5.6,
    minimumDeposit: 50000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "ЦентроКредит",
    Deposit: "Доход Плюс",
    Currency: "USD",
    monthlyDeposit: 1.15,
    minimumDeposit: 5000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Совкомбанк",
    Deposit: "Удобный (в долларах)",
    Currency: "USD",
    monthlyDeposit: 1,
    minimumDeposit: 500,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Веста",
    Deposit: "Веста - Копилка",
    Currency: "USD",
    monthlyDeposit: 1,
    minimumDeposit: 10000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Славия",
    Deposit: "Славный Капитал",
    Currency: "USD",
    monthlyDeposit: 0.85,
    minimumDeposit: 5000,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 4,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Роскосмосбанк",
    Deposit: "Комфортный",
    Currency: "USD",
    monthlyDeposit: 0.8,
    minimumDeposit: 500,
    maximumDeposit: null,
    minimumTerm: 3,
    MaximumTerm: 6,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "ФорБанк",
    Deposit: "Срочный накопительный",
    Currency: "USD",
    monthlyDeposit: 0.8,
    minimumDeposit: 10000,
    maximumDeposit: 500000,
    minimumTerm: 3,
    MaximumTerm: 3,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Московский Областной Банк",
    Deposit: "Гарантированный доллар",
    Currency: "USD",
    monthlyDeposit: 0.75,
    minimumDeposit: 50,
    maximumDeposit: null,
    minimumTerm: 4,
    MaximumTerm: 4,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Объединенный Резервный Банк",
    Deposit: "ОРБ-Накопительный (в конце срока)",
    Currency: "USD",
    monthlyDeposit: 1.6,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Банк Агора",
    Deposit: "Срочный",
    Currency: "USD",
    monthlyDeposit: 1.5,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Тинькофф Банк",
    Deposit: "СмартВклад (с повышенной ставкой)",
    Currency: "USD",
    monthlyDeposit: 1.5,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Первый Инвестиционный Банк",
    Deposit: "Закон сохранения",
    Currency: "USD",
    monthlyDeposit: 1.5,
    minimumDeposit: 1000,
    maximumDeposit: null,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  },
  {
    Bank: "Новый Век",
    Deposit: "Сберегательный",
    Currency: "USD",
    monthlyDeposit: 1.5,
    minimumDeposit: 5000,
    maximumDeposit: 20000,
    minimumTerm: 12,
    MaximumTerm: 12,
    avaliableMonthly: "TRUE"
  }
];

class Application {
  constructor() {
    let button = document.getElementById("button");
    button.addEventListener("click", this.check);
  }
  //Checking input data
  check() {
    const container = document.getElementById("container");
    container.className = "noneDisplay";
    let startAmount = document.getElementById("startAmount").value;
    let monthlyDeposit = document.getElementById("monthlyDeposit").value;
    let depositTerm = document.getElementById("depositTerm").value;
    let priceInput = document.getElementById("currency").value;
    let monthCheck = true;
    let input = {};

    if (
      startAmount > 0 &&
      monthlyDeposit > 0 &&
      depositTerm > 0 &&
      depositTerm % 1 == 0
    ) {
      input = new Deposit(startAmount, monthlyDeposit, depositTerm, priceInput);
      console.log(input);
      const bankproduct = new BankProduct(input, container);
      bankproduct.getResult(monthCheck);
    } else if (
      startAmount > 0 &&
      monthlyDeposit == 0 &&
      depositTerm > 0 &&
      depositTerm % 1 == 0
    ) {
      input = new Deposit(startAmount, monthlyDeposit, depositTerm, priceInput);
      console.log(input);
      monthCheck = false;
      const bankproduct = new BankProduct(input, container);
      bankproduct.getResult(monthCheck);
    } else {
      container.className = "noneDisplay";
      setTimeout(function() {
        alert("Input is not correct");
      }, 500);
      console.error("None correct input");
    }
  }
}
//creating new Input everytime user clicks Search button
class Deposit {
  constructor(startAmount, monthlyDeposit, depositTerm, priceInput) {
    this.startAmount = startAmount;
    this.monthlyDeposit = monthlyDeposit;
    this.depositTerm = depositTerm;
    this.priceInput = priceInput;
  }
}

class BankProduct {
  constructor(
    { startAmount, monthlyDeposit, depositTerm, priceInput },
    container
  ) {
    this.startAmount = startAmount;
    this.monthlyDeposit = monthlyDeposit;
    this.depositTerm = depositTerm;
    this.priceInput = priceInput;
    this.container = container;
    this.input = { startAmount, monthlyDeposit, depositTerm, priceInput };
  }

  getResult(monthCheck) {
    let result = dataExcel.filter(cal => {
      if (monthCheck == true && cal.maximumDeposit != null) {
        console.log("1");
        return (
          cal.minimumDeposit <= this.startAmount &&
          cal.maximumDeposit >= this.startAmount &&
          cal.minimumTerm <= this.depositTerm &&
          cal.MaximumTerm >= this.depositTerm &&
          cal.Currency == this.priceInput &&
          cal.avaliableMonthly == "TRUE"
        );
      } else if (monthCheck == true && cal.maximumDeposit == null) {
        console.log("2");
        return (
          cal.minimumDeposit <= this.startAmount &&
          cal.minimumTerm <= this.depositTerm &&
          cal.MaximumTerm >= this.depositTerm &&
          cal.Currency == this.priceInput &&
          cal.avaliableMonthly == "TRUE"
        );
      } else if (monthCheck == false && cal.maximumDeposit != null) {
        console.log("3");
        return (
          cal.minimumDeposit <= this.startAmount &&
          cal.maximumDeposit >= this.startAmount &&
          cal.minimumTerm <= this.depositTerm &&
          cal.MaximumTerm >= this.depositTerm &&
          cal.Currency == this.priceInput
          //cal.avaliableMonthly == "FALSE"      this is for if monthly deposit is zero and  accept it meaning like he didn't want monthly payment eligible
        );
      } else if (monthCheck == false && cal.maximumDeposit == null) {
        console.log("4");
        return (
          cal.minimumDeposit <= this.startAmount &&
          cal.minimumTerm <= this.depositTerm &&
          cal.MaximumTerm >= this.depositTerm &&
          cal.Currency == this.priceInput
          // cal.avaliableMonthly == "FALSE"    this is for if monthly deposit is zero and  accept it meaning like he didn't want monthly payment eligible
        );
      }
    });
    let calculator = new Calculator(result, container, this.input);
    console.log(result);
    calculator.drawTable();
  }
}
// Calculating avaliable bank offers
class Calculator {
  constructor(result, container, input) {
    this.result = result;
    this.container = container;
    this.input = input;
  }
  drawTable() {
    let bankdeposit = new BankDeposit();
    console.log(this.result);
    this.result.sort((a, b) => (a.monthlyDeposit < b.monthlyDeposit ? 1 : -1));

    container.className = "noneDisplay";
    if (this.result.length < 1) {
      setTimeout(function() {
        alert("sorry no option avaliable for this input");
      }, 500);

      console.error("None option for input");
    } else {
      container.className = "container-design";
      const arr = [];
      arr[0] =
        "<table><tr><th>Bank Name</th><th>Deposit</th><th>Percent</th><th>Future Value</th></tr>";
      for (let i = 0; i < this.result.length; i++) {
        const bankName = this.result[i].Bank;
        console.log(bankName);
        const deposit = this.result[i].Deposit;
        const percent = this.result[i].monthlyDeposit;
        let futureValue = Number(this.input.startAmount);
        for (let i = 0; i < this.input.depositTerm; i++) {
          futureValue =
            Number(futureValue) +
            (Number(futureValue) * Number(percent)) / 12 / 100 +
            Number(this.input.monthlyDeposit);
          console.log(futureValue);
        }

        futureValue = futureValue - Number(this.input.monthlyDeposit);
        if (i < 2) {
          arr[i + 1] = bankdeposit.getRowCode(
            bankName,
            deposit,
            percent,
            Math.round(futureValue),
            "tr" + i
          );
        }
      }
      container.innerHTML = "<table>" + arr.join("") + "</table>";
    }
  }
}
// creating table for avaliable bank offers
class BankDeposit {
  constructor() {}
  getRowCode(bankName, deposit, percent, futureValue, id) {
    const bankNamePart = "<td>" + bankName + "</td>";
    const depositPart = "<td>" + deposit + "</td>";
    const percentPart = "<td>" + percent + "</td>";
    const futureValuePart = "<td>" + futureValue + "</td>";

    let row =
      `<tr class="active" id=${id}>` +
      bankNamePart +
      depositPart +
      percentPart +
      futureValuePart +
      "</tr>";
    return row;
  }
}

new Application();
